# Select_contigs_reduced_multi.py
Generates HTML file of decomposed tetranucleotide plots with binned annotations. See <a href="https://cobiontid.github.io/examples/cbHylTriq8_scaffolds_multi_select.html">example</a>.
## Usage
Arguments:
- `--infile`: Path to .npy file with k-mer counts
- `--outfile`: Path of .html file to write results to
- `--seqidfile`: Path to file with sequence identifiers (one identifier per line, identifiers in same order as in the .npy file)
- `--annotfiles`: Path(s) to file(s) with annotations to be binned, surrounded by quotes if more than one, e.g. `"sample.hexsum sample.coverage"`. The number of rows in the files containing the annotations, sequence identifiers and k-mer counts must match.
- `--annotnames`: Label(s) for annotation(s), corresponding to annotation files provided, surrounded by quotes if more than one e.g. `"Density Coverage"`. Number of labels must match number of annotation files.
- `----bins`: Number of bins for annotations, default value = 5.
- `--discretize`: Discretize annotation by quantile (default if no value supplied), or linear (value other than "quantile" supplied).
- `--speciesname`: String with species or sample name (displayed in plot label).
- `--pca`: If set to `T`, reduce k-mers to two dimensions with PCA. Default to `F`(reduction with UMAP). 
- `--seqtype`: String with type of sequence, displayed in plot label (e.g. contigs or scaffolds).
- `--save_coords`: Path to store the x,y plot coordinates in .npy format. Optional. Output files can be loaded in Python with `import numpy as np; xy = np.load("coords.npy")`. Note that the coordinates may also be retrieved from the .html file that is generated by drawing a selection around points of interest, or all points, with the lasso tool, and clicking the "Save selection" button.
- `--save_tsv`: Path to store x,y coordinates in tab separated format (useful to generate input for BlobToolkit)
- `--keepbins': If set to `T`, `--annotfiles` may be provided with a list of integers (one per line), specifying a colour for each point. Useful for displaying categorical annotations, such as taxon assignments.
  - This option uses a discrete colour map, and can not be used in combination with inputs with continuous-valued annotations.
  - As a workaround, continous annotations can first be processed with https://github.com/CobiontID/kmer_decomposition/blob/main/VAE/utils/category_labels_from_cont.py to generate integers bins (but note that the colour map will change)
